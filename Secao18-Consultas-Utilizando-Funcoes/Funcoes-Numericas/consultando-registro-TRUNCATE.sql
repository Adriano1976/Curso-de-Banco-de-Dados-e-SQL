SELECT * FROM VENDEDORES

/*
+------------+----------+------+-----------+-----------+-----------+
| IDVENDEDOR | NOME     | SEXO | JANEIRO   | FEVEREIRO | MARCO     |
+------------+----------+------+-----------+-----------+-----------+
|          1 | CARLOS   | M    |  76234.78 |  88346.87 |   5756.90 |
|          2 | MARIA    | F    |   5865.78 |   6768.87 |   4467.90 |
|          3 | ANTONIO  | M    |  78769.78 |   6685.87 |   6664.90 |
|          4 | CLARA    | F    |   5779.78 | 446886.88 |   8965.90 |
|          5 | ANDERSON | M    | 676545.75 |  77544.87 | 578665.88 |
|          6 | IVONE    | F    |  57789.78 |  44774.87 |  68665.90 |
|          7 | JOAO     | M    |   4785.78 |  66478.87 |   6887.90 |
|          8 | CELIA    | F    |  89667.78 |  57654.87 |   5755.90 |
+------------+----------+------+-----------+-----------+-----------+
*/

-- Retorna o valor de uma coluna truncado para
-- “n” casas decimais. Diferentemente da função ROUND, a função TRUNCATE
-- NÃO FAZ ARREDONDAMENTO, ela simplesmente elimina algarismos.

/* A32 - OPERACOES ARITMETICA EM LINHA */

SELECT NOME,
	   JANEIRO,
	   FEVEREIRO,
	   MARCO,
	   (JANEIRO+FEVEREIRO+MARCO) AS "TOTAL",
	   ((JANEIRO+FEVEREIRO+MARCO)/3) AS "MEDIA"
	   FROM VENDEDORES;

/*
+----------+-----------+-----------+-----------+------------+---------------+
| NOME     | JANEIRO   | FEVEREIRO | MARCO     | TOTAL      | MEDIA         |
+----------+-----------+-----------+-----------+------------+---------------+
| CARLOS   |  76234.78 |  88346.87 |   5756.90 |  170338.55 |  56779.516113 |
| MARIA    |   5865.78 |   6768.87 |   4467.90 |   17102.55 |   5700.849935 |
| ANTONIO  |  78769.78 |   6685.87 |   6664.90 |   92120.55 |  30706.850423 |
| CLARA    |   5779.78 | 446886.88 |   8965.90 |  461632.56 | 153877.518392 |
| ANDERSON | 676545.75 |  77544.87 | 578665.88 | 1332756.49 | 444252.164062 |
| IVONE    |  57789.78 |  44774.87 |  68665.90 |  171230.55 |  57076.850260 |
| JOAO     |   4785.78 |  66478.87 |   6887.90 |   78152.55 |  26050.848958 |
| CELIA    |  89667.78 |  57654.87 |   5755.90 |  153078.55 |  51026.184082 |
+----------+-----------+-----------+-----------+------------+---------------+
*/


SELECT NOME,
	   JANEIRO,
	   FEVEREIRO,
	   MARCO,
	   (JANEIRO+FEVEREIRO+MARCO) AS "TOTAL",
	   TRUNCATE((JANEIRO+FEVEREIRO+MARCO)/3,2) AS "MEDIA"
	   FROM VENDEDORES;

/*
+----------+-----------+-----------+-----------+------------+-----------+
| NOME     | JANEIRO   | FEVEREIRO | MARCO     | TOTAL      | MEDIA     |
+----------+-----------+-----------+-----------+------------+-----------+
| CARLOS   |  76234.78 |  88346.87 |   5756.90 |  170338.55 |  56779.51 |
| MARIA    |   5865.78 |   6768.87 |   4467.90 |   17102.55 |   5700.84 |
| ANTONIO  |  78769.78 |   6685.87 |   6664.90 |   92120.55 |  30706.85 |
| CLARA    |   5779.78 | 446886.88 |   8965.90 |  461632.56 | 153877.51 |
| ANDERSON | 676545.75 |  77544.87 | 578665.88 | 1332756.49 | 444252.16 |
| IVONE    |  57789.78 |  44774.87 |  68665.90 |  171230.55 |  57076.85 |
| JOAO     |   4785.78 |  66478.87 |   6887.90 |   78152.55 |  26050.84 |
| CELIA    |  89667.78 |  57654.87 |   5755.90 |  153078.55 |  51026.18 |
+----------+-----------+-----------+-----------+------------+-----------+
*/

SELECT NOME,
	   JANEIRO,
	   FEVEREIRO,
	   MARCO,
	   (JANEIRO+FEVEREIRO+MARCO) AS "TOTAL",
	   ROUND((JANEIRO+FEVEREIRO+MARCO)/3,2) AS "MEDIA"
	   FROM VENDEDORES;

/*
+----------+-----------+-----------+-----------+------------+-----------+
| NOME     | JANEIRO   | FEVEREIRO | MARCO     | TOTAL      | MEDIA     |
+----------+-----------+-----------+-----------+------------+-----------+
| CARLOS   |  76234.78 |  88346.87 |   5756.90 |  170338.55 |  56779.52 |
| MARIA    |   5865.78 |   6768.87 |   4467.90 |   17102.55 |   5700.85 |
| ANTONIO  |  78769.78 |   6685.87 |   6664.90 |   92120.55 |  30706.85 |
| CLARA    |   5779.78 | 446886.88 |   8965.90 |  461632.56 | 153877.52 |
| ANDERSON | 676545.75 |  77544.87 | 578665.88 | 1332756.49 | 444252.16 |
| IVONE    |  57789.78 |  44774.87 |  68665.90 |  171230.55 |  57076.85 |
| JOAO     |   4785.78 |  66478.87 |   6887.90 |   78152.55 |  26050.85 |
| CELIA    |  89667.78 |  57654.87 |   5755.90 |  153078.55 |  51026.18 |
+----------+-----------+-----------+-----------+------------+-----------+
*/


SELECT NOME,
	   JANEIRO,
	   FEVEREIRO,
	   MARCO,
	   (JANEIRO+FEVEREIRO+MARCO) AS "TOTAL",
	   (JANEIRO+FEVEREIRO+MARCO) * .25 AS "DESCONTO",
	   TRUNCATE((JANEIRO+FEVEREIRO+MARCO)/3,2) AS "MEDIA"
	   FROM VENDEDORES;

/*
+----------+-----------+-----------+-----------+------------+-----------+-----------+
| NOME     | JANEIRO   | FEVEREIRO | MARCO     | TOTAL      | DESCONTO  | MEDIA     |
+----------+-----------+-----------+-----------+------------+-----------+-----------+
| CARLOS   |  76234.78 |  88346.87 |   5756.90 |  170338.55 |  42584.64 |  56779.51 |
| MARIA    |   5865.78 |   6768.87 |   4467.90 |   17102.55 |   4275.64 |   5700.84 |
| ANTONIO  |  78769.78 |   6685.87 |   6664.90 |   92120.55 |  23030.14 |  30706.85 |
| CLARA    |   5779.78 | 446886.88 |   8965.90 |  461632.56 | 115408.14 | 153877.51 |
| ANDERSON | 676545.75 |  77544.87 | 578665.88 | 1332756.49 | 333189.12 | 444252.16 |
| IVONE    |  57789.78 |  44774.87 |  68665.90 |  171230.55 |  42807.64 |  57076.85 |
| JOAO     |   4785.78 |  66478.87 |   6887.90 |   78152.55 |  19538.14 |  26050.84 |
| CELIA    |  89667.78 |  57654.87 |   5755.90 |  153078.55 |  38269.64 |  51026.18 |
+----------+-----------+-----------+-----------+------------+-----------+-----------+
*/

SELECT TRUNCATE(AVG(JANEIRO),2) AS MEDIA_JANEIRO FROM VENDEDORES;

/*
+---------------+
| MEDIA_JANEIRO |
+---------------+
|      124429.9 |
+---------------+
*/

SELECT TRUNCATE(AVG(FEVEREIRO),2) AS MEDIA_FEVEREIRO FROM VENDEDORES;

/*
+-----------------+
| MEDIA_FEVEREIRO |
+-----------------+
|        99392.74 |
+-----------------+
*/

SELECT TRUNCATE(AVG(MARCO),2) AS MEDIA_MARCO FROM VENDEDORES;

/*
+-------------+
| MEDIA_MARCO |
+-------------+
|    85728.89 |
+-------------+
*/

SELECT DEPARTAMENTO, 
TRUNCATE(AVG(SALARIO),2) AS MEDIA_SALARIAL
FROM FUNCIONARIOS
GROUP BY DEPARTAMENTO
ORDER BY 1;

/*
+---------------+----------------+
| DEPARTAMENTO  | MEDIA_SALARIAL |
+---------------+----------------+
| Alimentícios  |      101113.93 |
| Automotivo    |       99658.00 |
| Bebês         |       93749.42 |
| Beleza        |      103416.28 |
| Books         |       94890.14 |
| Brinquedos    |       96187.17 |
| Calçados      |       92281.81 |
| Computadores  |       99095.44 |
| Crianças      |       93237.55 |
| Eletronicos   |       91615.12 |
| Esporte       |       93901.02 |
| Ferramentas   |      105020.71 |
| Filmes        |       95268.66 |
| Games         |      103883.75 |
| Industrial    |       92900.85 |
| Jardim        |      101959.25 |
| Joalheria     |       87907.77 |
| Lar           |       92734.71 |
| Música        |       88507.21 |
| Outdoors      |      112055.41 |
| Roupas        |       95054.52 |
| Saúde         |       98975.65 |
+---------------+----------------+
*/