-- Processamento dos dados SEM os cursores.

SELECT * FROM VENDEDORES;

/*
+------------+------------+-------+--------+--------+
| IDVENDEDOR | NOME       | JAN   | FEV    | MAR    |
+------------+------------+-------+--------+--------+
|          1 | MAFRA      | 32432 | 242334 | 574545 |
|          2 | CLARA      | 65465 |  65443 | 653454 |
|          3 | JOAO       | 12432 |  65356 |   8756 |
|          4 | LILIAN     |  4567 |   9676 |   8765 |
|          5 | ANTONIO    |  3467 |  68756 |  99765 |
|          6 | GLORIA     | 54786 |  76889 |   7098 |
|          7 | MARIA      | 35532 | 325334 | 585445 |
|          8 | ESTER      | 68565 |  65323 | 659514 |
|          9 | ADRIANO    | 18542 |  63576 |   9586 |
|         10 | LAURA      |  4597 |   9676 |   8753 |
|         11 | NEIDE      |  3954 |  85456 |  99965 |
|         12 | GENALDO    | 52586 |  70259 |   7458 |
|         13 | ELISANGELA | 45932 | 248544 | 573215 |
|         14 | JANILSON   | 85465 |  78543 | 653654 |
|         15 | CRISTOVAO  | 12480 |  68526 |   4526 |
|         16 | ANTONY     |  4027 |   8576 |   8465 |
|         17 | ANTONIA    |  8567 |  68256 |  99765 |
|         18 | GLAUDIA    | 59586 |  74599 |  70798 |
+------------+------------+-------+--------+--------+
*/

SELECT NOME, JAN, FEV, MAR, (JAN+FEV+MAR) AS TOTAL 
FROM VENDEDORES;

/*
+------------+-------+--------+--------+--------+
| NOME       | JAN   | FEV    | MAR    | TOTAL  |
+------------+-------+--------+--------+--------+
| MAFRA      | 32432 | 242334 | 574545 | 849311 |
| CLARA      | 65465 |  65443 | 653454 | 784362 |
| JOAO       | 12432 |  65356 |   8756 |  86544 |
| LILIAN     |  4567 |   9676 |   8765 |  23008 |
| ANTONIO    |  3467 |  68756 |  99765 | 171988 |
| GLORIA     | 54786 |  76889 |   7098 | 138773 |
| MARIA      | 35532 | 325334 | 585445 | 946311 |
| ESTER      | 68565 |  65323 | 659514 | 793402 |
| ADRIANO    | 18542 |  63576 |   9586 |  91704 |
| LAURA      |  4597 |   9676 |   8753 |  23026 |
| NEIDE      |  3954 |  85456 |  99965 | 189375 |
| GENALDO    | 52586 |  70259 |   7458 | 130303 |
| ELISANGELA | 45932 | 248544 | 573215 | 867691 |
| JANILSON   | 85465 |  78543 | 653654 | 817662 |
| CRISTOVAO  | 12480 |  68526 |   4526 |  85532 |
| ANTONY     |  4027 |   8576 |   8465 |  21068 |
| ANTONIA    |  8567 |  68256 |  99765 | 176588 |
| GLAUDIA    | 59586 |  74599 |  70798 | 204983 |
+------------+-------+--------+--------+--------+
*/

SELECT NOME, JAN, FEV, MAR, (JAN+FEV+MAR) AS TOTAL, 
TRUNCATE(((JAN+FEV+MAR)/3),2) AS MEDIA 
FROM VENDEDORES;

/*
+------------+-------+--------+--------+--------+-----------+
| NOME       | JAN   | FEV    | MAR    | TOTAL  | MEDIA     |
+------------+-------+--------+--------+--------+-----------+
| MAFRA      | 32432 | 242334 | 574545 | 849311 | 283103.66 |
| CLARA      | 65465 |  65443 | 653454 | 784362 | 261454.00 |
| JOAO       | 12432 |  65356 |   8756 |  86544 |  28848.00 |
| LILIAN     |  4567 |   9676 |   8765 |  23008 |   7669.33 |
| ANTONIO    |  3467 |  68756 |  99765 | 171988 |  57329.33 |
| GLORIA     | 54786 |  76889 |   7098 | 138773 |  46257.66 |
| MARIA      | 35532 | 325334 | 585445 | 946311 | 315437.00 |
| ESTER      | 68565 |  65323 | 659514 | 793402 | 264467.33 |
| ADRIANO    | 18542 |  63576 |   9586 |  91704 |  30568.00 |
| LAURA      |  4597 |   9676 |   8753 |  23026 |   7675.33 |
| NEIDE      |  3954 |  85456 |  99965 | 189375 |  63125.00 |
| GENALDO    | 52586 |  70259 |   7458 | 130303 |  43434.33 |
| ELISANGELA | 45932 | 248544 | 573215 | 867691 | 289230.33 |
| JANILSON   | 85465 |  78543 | 653654 | 817662 | 272554.00 |
| CRISTOVAO  | 12480 |  68526 |   4526 |  85532 |  28510.66 |
| ANTONY     |  4027 |   8576 |   8465 |  21068 |   7022.66 |
| ANTONIA    |  8567 |  68256 |  99765 | 176588 |  58862.66 |
| GLAUDIA    | 59586 |  74599 |  70798 | 204983 |  68327.66 |
+------------+-------+--------+--------+--------+-----------+
*/




-- Processamento dos dados COM os cursores.

SELECT * FROM VENDEDORES;

/*
/*
+------------+------------+-------+--------+--------+
| IDVENDEDOR | NOME       | JAN   | FEV    | MAR    |
+------------+------------+-------+--------+--------+
|          1 | MAFRA      | 32432 | 242334 | 574545 |
|          2 | CLARA      | 65465 |  65443 | 653454 |
|          3 | JOAO       | 12432 |  65356 |   8756 |
|          4 | LILIAN     |  4567 |   9676 |   8765 |
|          5 | ANTONIO    |  3467 |  68756 |  99765 |
|          6 | GLORIA     | 54786 |  76889 |   7098 |
|          7 | MARIA      | 35532 | 325334 | 585445 |
|          8 | ESTER      | 68565 |  65323 | 659514 |
|          9 | ADRIANO    | 18542 |  63576 |   9586 |
|         10 | LAURA      |  4597 |   9676 |   8753 |
|         11 | NEIDE      |  3954 |  85456 |  99965 |
|         12 | GENALDO    | 52586 |  70259 |   7458 |
|         13 | ELISANGELA | 45932 | 248544 | 573215 |
|         14 | JANILSON   | 85465 |  78543 | 653654 |
|         15 | CRISTOVAO  | 12480 |  68526 |   4526 |
|         16 | ANTONY     |  4027 |   8576 |   8465 |
|         17 | ANTONIA    |  8567 |  68256 |  99765 |
|         18 | GLAUDIA    | 59586 |  74599 |  70798 |
+------------+------------+-------+--------+--------+
*/


SELECT * FROM VEND_TOTAL;

/*
Empty set (0.04 sec)
*/

-- Os registros que já existam na tabela VEND_TOTAL se repetem
-- na hora de chamar a procedure.
CALL INSEREDADOS();

/*
Query OK, 0 rows affected (4.86 sec)
*/


-- Os registros que já existam na tabela VEND_TOTAL não se repetem
-- na hora de chamar a procedure.
CALL INSEREDADOSNOREPEAT();

/*
Query OK, 0 rows affected (4.86 sec)
*/

SELECT * FROM VEND_TOTAL;

/*
+------------+-------+--------+--------+--------+--------+
| NOME       | JAN   | FEV    | MAR    | TOTAL  | MEDIA  |
+------------+-------+--------+--------+--------+--------+
| MAFRA      | 32432 | 242334 | 574545 | 849311 | 283104 |
| CLARA      | 65465 |  65443 | 653454 | 784362 | 261454 |
| JOAO       | 12432 |  65356 |   8756 |  86544 |  28848 |
| LILIAN     |  4567 |   9676 |   8765 |  23008 |   7669 |
| ANTONIO    |  3467 |  68756 |  99765 | 171988 |  57329 |
| GLORIA     | 54786 |  76889 |   7098 | 138773 |  46258 |
| MARIA      | 35532 | 325334 | 585445 | 946311 | 315437 |
| ESTER      | 68565 |  65323 | 659514 | 793402 | 264467 |
| ADRIANO    | 18542 |  63576 |   9586 |  91704 |  30568 |
| LAURA      |  4597 |   9676 |   8753 |  23026 |   7675 |
| NEIDE      |  3954 |  85456 |  99965 | 189375 |  63125 |
| GENALDO    | 52586 |  70259 |   7458 | 130303 |  43434 |
| ELISANGELA | 45932 | 248544 | 573215 | 867691 | 289230 |
| JANILSON   | 85465 |  78543 | 653654 | 817662 | 272554 |
| CRISTOVAO  | 12480 |  68526 |   4526 |  85532 |  28511 |
| ANTONY     |  4027 |   8576 |   8465 |  21068 |   7023 |
| ANTONIA    |  8567 |  68256 |  99765 | 176588 |  58863 |
| GLAUDIA    | 59586 |  74599 |  70798 | 204983 |  68328 |
+------------+-------+--------+--------+--------+--------+
*/

INSERT INTO VENDEDORES VALUES(NULL,'LETICIA',656,3546,234545);
INSERT INTO VENDEDORES VALUES(NULL,'CELIA',6766,56556,65454);

SELECT * FROM VENDEDORES;
SELECT * FROM VEND_TOTAL;

DELETE FROM VEND_TOTAL;

CALL INSEREDADOS();